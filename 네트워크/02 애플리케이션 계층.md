# Chapter 02. 애플리케이션 계층



## 2.1 네트워크 애플리케이션의 원리

네트워크 애플리케이션을 개발하려면 종단 시스템에서 실행되는 소프트웨어를 작성해야 한다.

라우터, 링크 계층 스위치와 같은 네트워크 코어 장비에서 실행되는 소프트웨어를 작성할 필요는 없다.



## 2.1.1 네트워크 애플리케이션의 구조

### 클라이언트-서버 구조(client-server architecture)

- 서버 : 항상 켜져있는 호스트
- 클라이언트 : 서버에게 요청하는 호스트

- 서버는 고정 IP 주소를 가짐
- 많은 요청을 처리하는 서버는 데이터 센터의 형태로 구성됨



### P2P 구조

- peer라는 간헐적으로 연결된 호스트끼리 직접 통신
- 자가 확장성(self-scalability)을 가지고 있음
- 각 피어가 파일을 요구 / 파일을 다른 피어에게 분배
- 서버 기반구조, 서버 대역폭을 거의 요구하지 않음
- 분산 구조 특성 -> 보안, 성능, 신뢰성 문제



## 2.1.2 프로세스 간 통신

- 한 프로세스가 다른 종단 시스템에서 실행되는 프로세스와 통신하는 것에 주목
- 컴퓨터 네트워크를 통한 **메시지** 교환으로 통신



### 클라이언트와 서버 프로세스

- 클라이언트 : 두 프로세스 간의 통신 세션에서 통신을 초기화하는 프로세스
- 서버 : 세션을 시작하기 위해 접속을 기다리는 프로세스



### 프로세스 - 컴퓨터 네트워크 사이의 인터페이스

- 프로세스는 **소켓(socket)**을 통해 네트워크로 메시지를 보내고 받는다.
- 소켓은 애플리케이션 계층 - 트랜스포트 계층 간의 인터페이스
  - 애플리케이션과 네트워크 사이의 API라고도 함
- 개발자는 소켓의 애플리케이션 계층에 대해 통제권을 가짐
  - 개발자가 트랜스포트 프로토콜 선택 -> 애플리케이션은 해당 프로토콜이 제공하는 전송 서비스를 사용하여 구성됨



### 프로세스 주소 배정

- 수신 프로세스 식별을 위해 필요한 정보
  1. 호스트의 주소
  2. 목적지 호스트 내의 수신 프로세스 식별자
- 호스트는 인터넷 상에서 **IP 주소**로 식별됨
  - IP주소는 32비트로 구성
  - 호스트를 유일하게 식별 가능
- 수신 호스트의 '수신 프로세스'를 식별하기 위해 **포트 번호**를 사용
  - 인기 있는 응용에는 특정 포트 번호 할당



## 2.1.3 애플리케이션이 이용 가능한 트랜스포트 서비스

**트랜스포트 프로토콜** : 네트워크를 통해 메시지를 수신 프로세스의 소켓으로 이동시키는 책임이 있음. 얘가 애플리케이션에 제공할 수 있는 서비스들을 살펴보자.



### 신뢰적 데이터 전송

- 패킷들은 컴퓨터 네트워크 내에서 손실될 수 있음(버퍼 오버플로우, 잘못된 패킷 비트)
- 데이터가 오류 없이 수신 프로세스에게 도착할 것이라는 확신을 제공
- **손실 허용 어플리케이션**(loss-tolerant application)의 경우 어느 정도의 데이터 손실을 참아낼 수 있음
  - 실시간 오디오/비디오 멀티미디어 어플리케이션 등



### 처리량

- 송신 프로세스가 수신 프로세스로 비트를 전달하는 속도
- 여러 세션이 경로에서 대역폭을 공유
  - 가용 처리율은 시간에 따라 변동
- 애플리케이션은 특정한 수준의 처리율을 보장해줄 것을 요구
- 트랜스포트 프로토콜은 가용한 처리율이 r bps임을 보장
- **대역폭 민감 애플리케이션**(bandwidth-sensitive application) : 처리율 요구사항을 갖는 애플리케이션
  - 멀티미디어 애플리케이션
- **탄력적 애플리케이션**(elastic application) : 처리율이 많으면 많은 대로, 적으면 적은 대로 이용
  - 전자 메일, 파일 전송, 웹 전송



### 시간

- timing guarantee를 제공 가능
- 데이터 전송에 엄격한 시간제한 조건 요구
- 상호 작용 실시간 애플리케이션에 요구됨
  - 인터넷 전화, 가상환경, 원격회의, 멀티플레이 게임



### 보안

- 두 프로세스 사이에 비밀성 제공
  - 송신 프로세스가 전송하는 모든 데이터를 **암호화**
  - 수신 프로세스로 데이터를 전달하기 전에 데이터의 암호를 **해독**
- 그 외에도 데이터 무결성, 종단 인증 제공



## 2.1.4 인터넷 전송 프로토콜이 제공하는 서비스

인터넷은 애플리케이션에게 2개의 전송 프로토콜(UDP, TCP)을 제공

애플리케이션 개발자는 UDP, TCP 중 어느 것을 사용할지를 결정해야 함



### TCP 서비스

- **연결지향형 서비스**
  - **핸드셰이킹** : 메시지를 전송하기 전에 클라이언트-서버가 전송 제어 정보를 교환
    - 패킷이 곧 도달할 것이니 준비하라고 알려줌
  - 핸드셰이킹 과정을 거치면 두 프로세스의 소켓 사이에 **TCP 연결**이 존재하게 됨
  - **전이중 연결**(full-duplex) : 두 프로세스가 서로에게 동시에 메시지를 보낼 수 있음
- **신뢰적인 데이터 전송 서비스**
  - 모든 데이터를 오류 없이 올바른 순서로 전달
  - 바이트 스트림을 손실하거나 중복되지 않게 수신 소켓으로 전달
- **혼잡제어 방식** : 인터넷 전체 성능 향상을 위한 서비스. 네트워크가 혼잡해지면 프로세스 속도를 낮춤.



### UDP 서비스

- 최소의 서비스 모델을 가진 간단한 전송 프로토콜
- **비연결형** 서비스 : 핸드셰이킹을 하지 않음
- **비신뢰적** 데이터 전송 서비스 : 메시지가 수신 소켓에 도착하는 것을 보장하지 않음. 순서가 바뀔 수도 있음
- 혼잡제어 방식 X : 송신 측은 데이터를 원하는 속도로 네트워크 계층으로 보낼 수 있음



### 인터넷 트랜스포트 프로토콜이 제공하지 않는 서비스

- TCP, UDP에서 처리율, 시간 보장에 대한 논의가 빠졌다고 해도,
  시간 민감 어플리케이션(e.g. 인터넷 전화)이 오늘날의 인터넷에서 수행될 수 없다는 것은 아니다.
  - 이러한 보장이 없는 경우에도 잘 대처할 수 있도록 설계됨
  - 다만 지연이 과도할 때는 한계가 있음
- 전자메일, 원격 터미널 접속, 웹, 파일 전송 : **TCP**. 신뢰적 데이터 전송 서비스
- 인터넷 전화 애플리케이션 : 패킷 손실 허용 & 최소의 전송 속도 보장해야 -> UDP를 선호.
  - but 많은 방화벽이 UDP 트래픽을 차단하도록 설정되어 있음 -> UDP 실패할 때 TCP 사용하도록 설계됨



## 2.1.5 애플리케이션 계층 프로토콜

프로세스가 보내는 메시지는 어떻게 구성되는가? 언제 보내지는가?

**애플리케이션 계층 프로토콜** 범위에서 이 질문을 답해보자.



애플리케이션 계층 프로토콜은 애플리케이션의 **프로세스가 메시지를 보내는 방법**을 정의

- 교환 메시지 타입(요청, 응답 메시지)
- 메시지 타입의 문법(메시지 내부의 필드, 필드 간의 구별 방법)
- 각 필드의 의미
- 언제, 어떻게 프로세스가 메시지를 전송하고 응답하는가에 대한 규칙



웹의 애플리케이션 계층 프로토콜 **HTTP**는 public domain 상의 RFC에서 찾을 수 있다.

- 브라우저 개발자가 HTTP RFC의 규칙을 따른다면,
  브라우저는 HTTP RFC 규칙을 따른 웹서버로부터 웹 페이지를 가져올 수 있음



스카이프는 비개방(독점) 애플리케이션 계층 프로토콜 사용 -> public domain에서 찾을 수 없다.



애플리케이션 계층 프로토콜은 네트워크 애플리케이션의 한 요소일 뿐이다.

네트워크 애플리케이션은 다음으로 구성된다.

- 문서 포맷 표준(HTML)
- 웹 브라우저
- 웹 서버
- 애플리케이션 계층 프로토콜



## 2.1.6 이 책에서 다루는 네트워크 애플리케이션

앞으로 중요하고 인기 있는 애플리케이션에 초점을 맞추겠다.

HTTP, FTP, 전자메일을 다룰 것이다.

그 이후에는 DNS, P2P, CDN을 다룰 것이다.

